# Линейные модели в машинном обучении

**ПОСТАНОВКА ЗАДАЧИ**

**Заказчик этого исследования** — владелец молочного хозяйства «Вольный луг». 
Нам нужно изучить и проанализировать данные о коровах от "ЭкоФерма", включающие информацию о прошлых удоях, качестве молока и других релевантных характеристиках. На основании этих данных необходимо разработать и внедрить две прогнозные модели для отбора бурёнок в поголовье:
- Первая будет прогнозировать возможный удой коровы (целевой признак Удой);
- Вторая — рассчитывать вероятность получить вкусное молоко от коровы (целевой признак Вкус молока).

**Исходные данные:** данные, предоставленные владелец молочного хозяйства. Набор данных содержит информацию о стаде фермера на текущий момент, имя папы каждой коровы в стаде фермера и о коровах «ЭкоФермы». 

**Цель исследования**: *Разработать и внедрить 2 модели машинного обучения:*
- **Прогноз удоя коровы (Целевой признак: Удой):**
    - Разработать модель машинного обучения, способную прогнозировать ожидаемый удой коровы за год.
    - Обеспечить точность предсказаний, чтобы фермер мог определить, соответствует ли корова установленным стандартам (не менее 6000 килограммов молока в год).
- **Оценка вкуса молока (Целевой признак: Вкус молока):**
    - Разработать модель, способную рассчитывать вероятность получения вкусного молока от каждой коровы.
    - Использовать критерии фермера для определения качества молока и учесть их в модели.
**Ход исследования**

Данные от владельца молочного хозяйства «Вольный луг» мы получим из файлов `/datasets/ferma_main.csv (данные о стаде фермера на текущий момент), /datasets/ferma_dad.csv (данные имен пап каждой коровых в стаде фермера) и /datasets/cow_buy.csv (данные о коровах «ЭкоФермы»).` О качестве данных ничего не известно. Поэтому перед созданием прогнозных моделей понадобится обзор данных.

Мы проверим данные на ошибки и оценим их влияние на исследование. Затем, на этапе предобработки мы отыщем возможность исправить самые критичные ошибки данных. Далее проведем исследовательский анализ данных и выявим основные закономерности в данных. После этого подготовим данные к машинному обучению, путем объединения данных. Сформируем выборки, при необходимости отмасштабируем количественные данные и закодируем количественные. А в завершении разработаем и внедрим 2 модели машинного обучения.

Таким образом, исследование пройдёт в семь этапов:
1. Обзор Данных:
    - Получение данных от "Вольный луг" и "ЭкоФерма".
    - Проверка данных на ошибки и оценка их влияния на исследование.
2. Предобработка Данных:
    - Исправление критичных ошибок данных.
    - Объединение данных для последующего анализа.
3. Исследовательский Анализ Данных:
    - Анализ основных закономерностей в данных.
    - Визуализация распределений и взаимосвязей.
4. Корреляционный Анализ:
    - Оценка корреляции между признаками и целевыми переменными.
5. Обучение Модели Линейной Регрессии:
    - Разработка модели для прогнозирования удоя коровы.
    - Оценка качества модели на обучающем наборе данных.
6. Обучение Модели Логистической Регрессии:
    - Создание модели для оценки вероятности вкусного молока.
    - Учет критериев фермера при построении модели.
7. Итоговые Выводы:
    - Сравнение результатов моделей с установленными стандартами.
    - Формулирование рекомендаций фермеру "Вольный луг" по отбору бурёнок.

# ОБЩИЙ ВЫВОД

1. ***Раздел. Загрузка и первичный обзор данных:***
   - В ходе этого раздела были успешно загружены данные о коровах, проведен обзор их структуры и содержания.
   - Обнаружены необходимости по переименованию столбцов для удобства работы и проверки типов данных.
   - Пропущенных значений не выявлено, однако обнаружены моменты требующие дальнейшей проверки, такие как корректность значений в числовых столбцах.


2. ***Раздел. Предобработка данных:***
   - Применены методы удаления явных и неявных дубликатов, а также обработаны аномалии в числовых данных.
   - Для удобства анализа и работы с данными были добавлены новые столбцы и изменены типы данных на категориальные.
   - Подготовленные данные готовы к дальнейшему анализу и построению моделей.


3. ***Раздел. Исследовательский анализ данных:***
   - Анализ продуктивности коров позволил выявить ключевые характеристики, такие как удой, содержание протеина и жира в молоке, и возраст коров.
   - Полученные выводы помогут фермеру лучше понять состав своего стада и определить факторы, влияющие на его производительность.


4. ***Раздел. Корреляционный анализ:***
   - Были выявлены различные взаимосвязи между параметрами, включая высокую корреляцию удоя с энергетической ценностью корма и содержанием протеина в молоке.
   - Обнаружены нелинейные связи и мультиколлинеарность, которые могут повлиять на построение моделей.


5. ***Раздел. Обучение модели линейной регрессии:***
   - Были построены три модели линейной регрессии с последовательным улучшением качества предсказаний.
   - Модели демонстрировали высокую объясняющую способность удоя молока, однако анализ остатков выявил нелинейности, требующие дополнительного внимания.
   - Прогнозы модели позволяют фермеру принимать обоснованные решения о покупке коров, минимизируя риски приобретения менее продуктивных особей.


6. ***Раздел. Обучение модели логистической регрессии:***
   - Построенная модель классификации вкуса молока демонстрирует умеренную способность различать вкусное и невкусное молоко, однако требует дальнейшей настройки и улучшения метрик Precision и Recall.
   - Применение модели для предсказания вкуса молока коров, которые планируется купить, предоставляет фермеру дополнительную информацию для обоснованного выбора.


7. ***Раздел. Выбор коров с высоким удоем и вкусным молоком***:
   - Из анализа моделей следует, что фермер может выбрать четыре коровы из представленного стада на продажу, соответствующие критериям удоя более 6000 кг в год и вкусного молока. Эти коровы представляют собой наиболее перспективные для покупки с точки зрения предполагаемой производительности и качества продукции, что делает их приобретение экономически обоснованным с минимальным риском.


8. **Улучшение моделей линейной и логистической регрессии**:
   - **Сбор большего объема данных**: Пополнение базы данных о коровах может улучшить точность моделей.
   - **Использование сложных моделей**: Введение ансамблевых методов или машинного обучения с учителем может дать более точные прогнозы.
   - **Функции предварительной обработки**: Применение методов отбора признаков и инженерии признаков для повышения информативности данных.
   - **Кросс-валидация**: Использование кросс-валидации для оценки устойчивости моделей на разных наборах данных.

Таким образом, эти рекомендации помогут фермеру принять обоснованные решения о покупке коров и улучшить производственные показатели своего хозяйства.
В целом, использование моделей машинного обучения в сельском хозяйстве представляет собой эффективный инструмент для принятия обоснованных решений о покупке и управлении стадом. Несмотря на достигнутые результаты, дальнейшее совершенствование моделей и методов анализа данных может дополнительно повысить их эффективность и точность предсказаний.